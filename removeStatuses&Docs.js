db.claims.find({
    "customClaimNumber": {
        $in: [
            "P001-1881275024-34798550",
            "P001-1889380969-34806949",
            "P001-8917297675-34807176",
            "P001-9150874870-34807531",
            "P001-2701171438-34808392",
            "P001-9936624043-34809338",
            "P001-6096767155-34809527",
            "P001-5681909565-34809543",
            "P001-1309766888-34809868",
            "P001-8353746247-34810432",
            "P001-4183120629-34810608",
            "P001-4524859148-34810656",
            "P001-2437102643-34813057",
            "P001-5905578727-34817370",
            "P001-0064592817-34820553",
            "P001-5895405259-34820868",
            "P001-5570400634-34821064",
            "P001-2115853763-34821192",
            "P001-4724984099-34805021",
            "P001-9700246729-34807208",
            "P001-1141938642-34808093",
            "P001-6344909071-34808986",
            "P001-2202520450-34814110",
            "P001-9120343917-34818036",
            "P001-6132477672-34819892",
            "P001-7736091442-34820541",
            "P001-2683124315-34807652",
            "P001-3201091615-34809353",
            "P001-5815966581-34809592",
            "P001-8356749838-34814722",
            "P001-6413177589-34817424",
            "P001-7787554209-34818124",
            "P001-4990617533-34818638",
            "P001-6831906789-34821396",
            "P001-4541872069-34818341",
            "P001-9868795073-34819251",
            "P001-1544953725-34815353",
            "P001-3125084164-34813758",
            "P001-9085256401-34816224",
            "P001-8224372210-34810298",
            "P001-7261069525-34804604",
            "P001-2506840260-34810049",
            "P001-3942902321-34799523",
            "P001-4341398838-34804600",
            "P001-8088235713-34805156",
            "P001-5180257448-34805504",
            "P001-5945557514-34806792",
            "P001-8583723879-34806854",
            "P001-2270611482-34807104",
            "P001-3763379108-34807308",
            "P001-7315445967-34808991",
            "P001-9752652894-34809195",
            "P001-5290989848-34809481",
            "P001-2261080027-34810615",
            "P001-6111917504-34814082",
            "P001-3781853238-34814266",
            "P001-1955888773-34814377",
            "P001-7354955740-34814866",
            "P001-5113973331-34815993",
            "P001-3849886354-34816463",
            "P001-6790435966-34817168",
            "P001-6466493599-34818528",
            "P001-9572182841-34818647",
            "P001-4878721171-34818706",
            "P001-6706108418-34818716",
            "P001-2873970770-34820627",
            "P001-4785308000-34805054",
            "P001-9448547454-34807314",
            "P001-7774635121-34807559",
            "P001-0006012540-34810396",
            "P001-3554987550-34810192",
            "P001-7223665834-34813110",
            "P001-8603565758-34816710",
            "P001-9131394750-34817994",
            "P001-1679078326-34821487",
            "P001-5849879650-34806755",
            "P001-9300518441-34807192",
            "P001-7178426581-34807983",
            "P001-1548799588-34808505",
            "P001-3060626998-34809045",
            "P001-6794015750-34810088",
            "P001-0667562556-34810775",
            "P001-7460981710-34810957",
            "P001-3504833186-34813427",
            "P001-2599907513-34814756",
            "P001-9585262699-34816965",
            "P001-6370811476-34817074",
            "P001-4560525041-34817864",
            "P001-3712241588-34818409",
            "P001-2071279789-34819104",
            "P001-4460954623-34820834",
            "P001-9108908202-34820980",
            "P001-3254017851-34821521",
            "P001-1111312957-34810650",
            "P001-7999055369-34813472",
            "P001-0041969782-34813538",
            "P001-2038515139-34814881",
            "P001-7617384027-34807836",
            "P001-0709201879-34812194",
            "P001-2890758644-34811664",
            "P001-7483247770-34809928",
            "P001-6097091762-34807651",
            "P001-7326449549-34820516",
            "P001-0746658176-34805616",
            "P001-1823751303-34806878",
            "P001-1269064958-34807558",
            "P001-9797007719-34807942",
            "P001-9754865387-34808446",
            "P001-9692787963-34809802",
            "P001-2175453244-34813504",
            "P001-4305014009-34814613",
            "P001-6554980907-34814715",
            "P001-0180103841-34814839",
            "P001-6252646640-34815973",
            "P001-3358935750-34817097",
            "P001-4367708350-34818619",
            "P001-0988807080-34820238",
            "P001-4490172567-34820467",
            "P001-6511442678-34820995",
            "P001-9269389865-34821590",
            "P001-8384882332-34805082",
            "P001-7738268043-34806207",
            "P001-3864101406-34809043",
            "P001-9624931487-34808109",
            "P001-2059345439-34814599",
            "P001-6355388762-34820913",
            "P001-7509449062-34807064",
            "P001-8333859248-34808654",
            "P001-0417767351-34808766",
            "P001-4547618218-34808972",
            "P001-2835144828-34814058",
            "P001-9361524822-34817775",
            "P001-1309868250-34818343",
            "P001-3648189802-34818361",
            "P001-8730221289-34819643",
            "P001-5406053158-34820715",
            "P001-7650370970-34821410",
            "P001-9925340832-34821466",
            "P001-9795478566-34820125",
            "P001-0958150829-34814523",
            "P001-4708413870-34815879",
            "P001-1437713379-34813331",
            "P001-8679605303-34813362",
            "P001-1643869133-34808640",
            "P001-4834553842-34808525",
            "P001-7699551775-34807006",
            "P001-0436355988-34804792",
            "P001-7683494872-34806677",
            "P001-4662483688-34807039",
            "P001-2347353500-34819175",
            "P001-4518650955-34818142",
            "P001-1439724166-34799527",
            "P001-6083336757-34806912",
            "P001-3157277087-34807013",
            "P001-6781773708-34807131",
            "P001-7775637846-34807610",
            "P001-8191206922-34807926",
            "P001-3114226876-34808428",
            "P001-8200059658-34808804",
            "P001-7398289548-34809574",
            "P001-0249632177-34810093",
            "P001-6590663740-34810337",
            "P001-5815966581-34810586",
            "P001-2245379700-34812847",
            "P001-9886763890-34813140",
            "P001-0563294810-34813488",
            "P001-8436676763-34813715",
            "P001-4118737817-34814001",
            "P001-9755410552-34814365",
            "P001-3743824597-34816735",
            "P001-8407624584-34817310",
            "P001-6812009299-34817737",
            "P001-6946379902-34818339",
            "P001-3876181276-34818652",
            "P001-1005432327-34819967",
            "P001-8225159684-34820239",
            "P001-1653227465-34805062",
            "P001-7068216361-34807969",
            "P001-8158499520-34809212",
            "P001-2538358691-34809294",
            "P001-7550566535-34813620",
            "P001-3359673584-34814030",
            "P001-4523618659-34814375",
            "P001-5511570202-34807112",
            "P001-6310569344-34821591",
            "P001-6129473188-34800105",
            "P001-5206105428-34806789",
            "P001-7089771681-34810201",
            "P001-4021600580-34813565",
            "P001-0273089728-34814811",
            "P001-8878937466-34817502",
            "P001-9109571067-34818292",
            "P001-9837912736-34817614",
            "P001-7845670151-34807481",
            "P001-4085675655-34814152",
            "P001-2520672088-34813915",
            "P001-0011070290-34811031",
            "P001-5046060027-34810199",
            "P001-5609820295-34807164",
            "P001-6734756672-34813387",
            "P001-8771212148-34817726",
            "P001-6677930478-34819053",
            "P001-8978318626-34815631",
            "P001-6592254815-34820411",
            "P001-8661909160-34796638",
            "P001-4854464388-34804669",
            "P001-5564768562-34806719",
            "P001-7794427254-34807658",
            "P001-8798999507-34807916",
            "P001-0372131971-34808607",
            "P001-4135902008-34808732",
            "P001-2755144428-34809196",
            "P001-34809374",
            "P001-9185438317-34809891",
            "P001-7067012378-34809935",
            "P001-4168054537-34809991",
            "P001-7114539256-34813210",
            "P001-1229680916-34813353",
            "P001-3551208568-34814175",
            "P001-5537106523-34814487",
            "P001-2293226681-34814689",
            "P001-1229577842-34814805",
            "P001-9895399108-34817709",
            "P001-8065365020-34819431",
            "P001-0867738356-34820335",
            "P001-6986017061-34805101",
            "P001-0289840205-34806601",
            "P001-6309664825-34809471",
            "P001-9126997590-34813420",
            "P001-4414064261-34813157",
            "P001-6598503683-34813498",
            "P001-8757505740-34820559",
            "P001-3756978814-34821154",
            "P001-5522634355-34796398",
            "P001-7692579473-34797898",
            "P001-2534519354-34808148",
            "P001-3416395586-34808305",
            "P001-7930391320-34810991",
            "P001-4747676157-34814041",
            "P001-6302556236-34814770",
            "P001-4135567382-34816474",
            "P001-4999953318-34816997",
            "P001-0233107738-34818663",
            "P001-3157149048-34819268",
            "P001-1118539836-34812655",
            "P001-5477385174-34816492",
            "P001-1389643329-34813754",
            "P001-5379103930-34807958",
            "P001-4326924215-34809421",
            "P001-1818116579-34806635",
            "P001-4702256582-34817644",
            "P001-3226046118-34820920",
            "P001-1536908163-34803707",
            "P001-0422520780-34804259",
            "P001-9397972071-34804424",
            "P001-8370144721-34807113",
            "P001-1625455497-34808569",
            "P001-2888782405-34808682",
            "P001-4945408952-34810010",
            "P001-4636488043-34810269",
            "P001-2507947990-34811878",
            "P001-2506457203-34813380",
            "P001-0756811379-34813907",
            "P001-8974466296-34814078",
            "P001-8009857654-34816301",
            "P001-5825629703-34816323",
            "P001-1620771959-34819137",
            "P001-4374514177-34820131",
            "P001-9411085075-35115387",
            "P001-9411085075-35157470",
            "P001-3318826205-34807228",
            "P001-6960991174-34807494",
            "P001-5768271434-34806879",
            "P001-3598364055-34810561",
            "P001-8134056998-34814542",
            "P001-0024231752-34817824",
            "P001-3136252711-34820035",
            "P001-2483749584-34810883",
            "P001-2833760777-34814580",
            "P001-0622466020-34814724",
            "P001-8007459747-34820801",
            "P001-6637256475-34818249",
            "P001-9797012634-34810621",
            "P001-1912688303-34806449",
            "P001-3805190576-34812966",
            "P001-6879403101-34814525",
            "P001-4211779231-34814287",
            "P001-7335696264-34810513",
            "P001-8610182086-34810083",
            "P001-1776828800-34808887"
        ]
    }
}).forEach(function (claim) {
    var ccn = claim.customClaimNumber;
    var id = claim._id;

    var statuses = db.claims_status.find({
        "claimId": id.valueOf()
    }).sort({
        "statusDate": 1
    }).toArray();
    if (statuses.length && statuses[0].statusCode == "2") {
        var statusesRemoveCount = 0;
        for (var i = 1; i < statuses.length; i++) {
            var statusId = statuses[i]._id;
            var statusRemove = db.claims_status.remove({
                "_id": statusId
            });
            statusesRemoveCount += statusRemove.nRemoved;
        }
        var newCurrStatus = statuses[0];
        delete newCurrStatus._class;
        
        var updCurr = db.claims.update({
            "_id": id
        },{
            $set: {
                "currStatus" : newCurrStatus
            }
        });
        updCurr.nStatus = updCurr.nModified == 1 ? ", currStatus has been corrected" : ", didn't correct currStatus [ERROR]";

        var message = "Claim: " + ccn + ", statuses has been removed: " + statusesRemoveCount + updCurr.nStatus;
        
        var searchDocs = db.docs.find({
            "ownerId": id.valueOf()
        }).toArray();

        if (searchDocs.length) {
            var docsRemoveCount = db.docs.remove({
                "ownerId": id.valueOf()
            });

            message += ", docs has been removed: " + docsRemoveCount.nRemoved;
        }

        if (claim.resultStatus != undefined) {
            var upd = db.claims.update({
                "_id": id
            }, {
                $unset: {
                    "resultStatus": "",
                    "docSendDate": ""
                }
            });
            upd.nStatus = upd.nModified == 1 ? "has been removed." : "didn't remove [ERROR]";
            message += ", resultStatus " + upd.nStatus;
        }

        print(message);
    } else {
        print("[ERROR] Claim: " + ccn + ' have wrong status model.');
    }
})