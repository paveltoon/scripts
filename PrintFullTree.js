var departArr = [
    "10000001077",
    "10000001082",
    "10000001083",
    "10000001086",
    "10000001169",
    "10000001182",
    "10000001197",
    "10000001214",
    "10000001257",
    "10000001265",
    "10000001764",
    "10000002268",
    "10000002755",
    "10000002796",
    "10000002895",
    "10000008589",
    "10000015911",
    "10000038334",
    "10000058597",
    "10001004035",
    "10001022717",
    "10001291504",
    "10002421615",
    "10002963390",
    "1213213213",
    "123",
    "123000123",
    "1234",
    "12345",
    "123456",
    "178",
    "188487658",
    "2222222222",
    "260520154016",
    "5000000000160301554",
    "5000000000163327204",
    "5000000000166727055",
    "5000000000166728160",
    "5000000000166728182",
    "5000000000166728504",
    "5000000000166728523",
    "5000000000166728597",
    "5000000000166728699",
    "5000000000166728864",
    "5000000000166728867",
    "5000000000166728913",
    "5000000000166728979",
    "5000000000166729076",
    "5000000000166729624",
    "5000000000166729691",
    "5000000000166729811",
    "5000000000166729878",
    "5000000000166729946",
    "5000000000166729963",
    "5000000000166730059",
    "5000000000166730172",
    "5000000000166730271",
    "5000000000166730426",
    "5000000000166730468",
    "5000000000166730538",
    "5000000000166730555",
    "5000000000166730611",
    "5000000000166731176",
    "5000000000166731243",
    "5000000000166731332",
    "5000000000166731399",
    "5000000000166731546",
    "5000000000166731648",
    "5000000000166731804",
    "5000000000166731821",
    "5000000000166731965",
    "5000000000166732039",
    "5000000000166732124",
    "5000000000166732141",
    "5000000000166732190",
    "5000000000166732260",
    "5000000000166732327",
    "5000000000166732414",
    "5000000000166732431",
    "5000000000166732581",
    "5000000000166732653",
    "5000000000166732729",
    "5000000000166732746",
    "5000000000166732800",
    "5000000000166732869",
    "5000000000166732886",
    "5000000000166732936",
    "5000000000166732953",
    "5000000000166733004",
    "5000000000166733086",
    "5000000000166733155",
    "5000000000166733227",
    "5000000000166733247",
    "5000000000166733302",
    "5000000000166733371",
    "5000000000166733499",
    "5000000000166733516",
    "5000000000166733566",
    "5000000000166733633",
    "5000000000166733700",
    "5000000000166734764",
    "5000000000167117614",
    "5000000000167117765",
    "5000000000167142825",
    "5000000000167180326",
    "5000000000167234437",
    "5000000000167235253",
    "5000000000167236134",
    "5000000000167237170",
    "5000000000167238467",
    "5000000000167238775",
    "5000000000167239247",
    "5000000000167359115",
    "5000000000167359243",
    "5000000000167359370",
    "5000000000167359497",
    "5000000000167359624",
    "5000000000167359751",
    "5000000000167359878",
    "5000000000167360003",
    "5000000000167360128",
    "5000000000167360253",
    "5000000000167360378",
    "5000000000167360503",
    "5000000000167360628",
    "5000000000167360751",
    "5000000000167360876",
    "5000000000167361001",
    "5000000000167361126",
    "5000000000167361251",
    "5000000000167361376",
    "5000000000167361501",
    "5000000000167361626",
    "5000000000167361751",
    "5000000000167361877",
    "5000000000167362002",
    "5000000000167362127",
    "5000000000167362252",
    "5000000000167362377",
    "5000000000167362502",
    "5000000000167362627",
    "5000000000167362753",
    "5000000000167362878",
    "5000000000167363003",
    "5000000000167363257",
    "5000000000167363380",
    "5000000000167363505",
    "5000000000167363632",
    "5000000000167363757",
    "5000000000167363882",
    "5000000000167364007",
    "5000000000167364132",
    "5000000000167364257",
    "5000000000167364382",
    "5000000000167364507",
    "5000000000167364632",
    "5000000000167364757",
    "5000000000167364882",
    "5000000000167365007",
    "5000000000167365132",
    "5000000000167365257",
    "5000000000167365382",
    "5000000000167365507",
    "5000000000167365633",
    "5000000000167365758",
    "5000000000167365883",
    "5000000000167366008",
    "5000000000167366131",
    "5000000000167366256",
    "5000000000167366381",
    "5000000000167366506",
    "5000000000167366631",
    "5000000000167366754",
    "5000000000167366879",
    "5000000000167367006",
    "5000000000167367133",
    "5000000000167367260",
    "5000000000167367387",
    "5000000000167367514",
    "5000000000167367641",
    "5000000000167367768",
    "5000000000173557974",
    "5000000000174928401",
    "5000000000174928483",
    "5000000000175406124",
    "5000000000177914050",
    "5000000000178112908",
    "5000000000179232362",
    "5000000000180693864",
    "5000000000181421819",
    "5000000000181422571",
    "5000000000181438659",
    "5000000000181446750",
    "5000000000181448098",
    "5000000000181481602",
    "5000000000181514028",
    "5000000000181514084",
    "5000000000181609960",
    "5000000000181746811",
    "5000000000183990238",
    "5000000000184041231",
    "5000000000184405703",
    "5000000000185787336",
    "5000000000186405681",
    "5000000000186564525",
    "5000000000186878759",
    "5000000000194877633",
    "5000000000195195777",
    "5000000000196430396",
    "5000000010000000001",
    "5000000010000000186",
    "5000000010000000193",
    "5000000010000000255",
    "5000000010000000261",
    "5000000010000000267",
    "5000000010000000279",
    "5000000010000000285",
    "5000000010000000303",
    "5000000010000000315",
    "5000000010000000328",
    "5000000010000000334",
    "5000000010000000340",
    "5000000010000000365",
    "5000000010000000371",
    "5000000010000000377",
    "5000000010000000452",
    "5000000010000000458",
    "5000000010000000464",
    "5000000010000047147",
    "5000000010000065366",
    "5000000010000066008",
    "5000000010000071548",
    "5000000010000076673",
    "5000000010000087101",
    "5000000010000092122",
    "5000000010000093172",
    "5000000010000117494",
    "5000000010000127717",
    "5000000010000183490",
    "5000000011111111",
    "500000032679872900029",
    "5021800010000007450",
    "5050505051",
    "5050505052",
    "6726670987654",
    "99999998888888"
]
print("Наименование Департамента;Идентификатор Департамента;Наименование Услуги;Идентификатор Услуги;Наименование Процедуры;Идентификатор Процедуры")
for (var i in departArr) {
    var passId = db.claims.distinct("service.srguServicePassportId", {
        "service.srguDepartmentId": departArr[i]
    });
    var depNameFind = db.claims.findOne({
        "service.srguDepartmentId": departArr[i],
        "service.srguDepartmentName": { $exists: true }
    });
    if (depNameFind != (undefined && null)) {
        var depName = depNameFind.service.srguDepartmentName;
        if (passId.length != 0) {

            for (var j in passId) {
                var passNameFind = db.claims.findOne({
                    "service.srguServicePassportId": passId[j],
                    "service.srguServicePassportName": { $exists: true }
                });
                if( passNameFind != (undefined && null)){
                    var passName = passNameFind.service.srguServicePassportName;
                } else {
                    var passName = "Наименование услуги отсутствует"
                }
                
                var servId = db.claims.distinct("service.srguServiceId", {
                    "service.srguServicePassportId": passId[j]
                });
                for (var z in servId) {
                    var servNameFind = db.claims.findOne({
                        "service.srguServiceId": servId[z],
                        "service.name": { $exists: true }
                    });
                    if(servNameFind != (undefined && null)){
                        var servName = servNameFind.service.name;
                    } else {
                        var servName = "Наименование процедуры отсутствует"
                    }
                    
                    print(depName + ';' + departArr[i] + ';' + passName + ';' + passId[j] + ';' + servName + ';' + servId[z])

                }
            }

        }

    }
}