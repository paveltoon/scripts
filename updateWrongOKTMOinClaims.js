var oktmos = {
    "mfc-leninskiy": "46628000",
    "mfc-dzerjinskiy-zhukova": "46711000",
    "mfc-korolev2": "46734000",
    "mfc-protvino": "46767000",
    "mfc-elektrostal-pobedi": "46790000",
    "mfc-krasnogorsk-pp": "46744000",
    "mfc-krasnogorsk-mechnikovo": "46744000",
    "mfc-krasnogorsk2": "46744000",
    "mfc-work-etalon": "46641000",
    "mfc-krasnogorsk": "46744000",
    "mfc-tomilino": "46748000",
    "mfc-narofominsk": "46750000",
    "mfc-pyshino": "46762000",
    "mfc-mingos": "46641000",
    "mfc-volokolamsk": "46605000",
    "mfc-ramenskoe": "46648000",
    "mfc-nikolskoe": "46641000",
    "mfc-solnechnogorsk": "46652000",
    "mfc-dzerjinskiy": "46711000",
    "mfc-lubychanskoe": "46784000",
    "mfc-ozery": "46756000",
    "mfc-talalihino": "46709000",
    "mfc-mytishi-karla-marksa": "46746000",
    "mfc-domodedovo-2": "46709000",
    "mfc-ivanteevka": "46732000",
    "mfc-ubileinyi": "46734000",
    "mfc-beloozerskiy": "46606000",
    "mfc-voshod": "46763000",
    "mfc-ku": "40004000",
    "mfc-luberci-oktyabrskiy": "46748000",
    "mfc-pushkino": "46647000",
    "mfc-korolev": "46734000",
    "mfc-noginsk": "46751000",
    "mfc-kolomenskiymr": "46738000",
    "mfc-odincovo": "46641000",
    "mfc-voskresensk": "46606000",
    "mfc-zaraisk": "46729000",
    "mfc-nahabino": "46744000",
    "mfc-fryazino": "46780000",
    "mfc-krasnoznamensk": "46706000",
    "mfc-aprelevka-clone": "46750000",
    "mfc-hotkovo": "46615000",
    "mfc-istra": "46733000",
    "mfc-shhelkovo": "46659000",
    "mfc-mojaisk": "46745000",
    "mfc-ramenskoe-vorovskogo": "46648000",
    "mfc-odincovo-clone": "46641000",
    "mfc-noginsk-kirova": "46751000",
    "mfc-kalininec": "46750000",
    "mfc-stage": "46641000",
    "mfc-dolgoprudniy": "46716000",
    "mfc-stupino": "46776000",
    "mfc-kotelniki": "46739000",
    "mfc-elektrostal": "46790000",
    "mfc-domodedovo-avia": "46709000",
    "mfc-odincovo-clone2": "46641000",
    "mfc-mytishi-letnaya": "46746000",
    "mfc-five-stage": "46641000",
    "mfc-dedovsk": "46733000",
    "mfc-vlasiha": "46773000",
    "mfc-podolsk-kirova": "46760000",
    "mfc-ryza": "46766000",
    "mfc-balashiha": "46704000",
    "mfc-shatura": "46786000",
    "mfc-lytkarino": "46741000",
    "mfc-egorievsk": "46722000",
    "mfc-losino-petrovsk": "46742000",
    "mfc-pavlovskiy-posad": "46759000",
    "mfc-pavlovskiy-posad-pokrovskaya": "46759000",
    "mfc-reytov": "46764000",
    "mfc-shodnya": "46783000",
    "mfc-himki": "46783000",
    "mfc-tuchkovo": "46766000",
    "mfc-kiln": "46737000",
    "mfc-shahovskoy": "46787000",
    "mfc-domodedovo": "46709000",
    "mfc-zorya": "46704000",
    "mfc-likino-dulevo": "46749000",
    "mfc-luhovitci": "46747000",
    "mfc-dubna-svobodi": "46718000",
    "mfc-roshal": "46765000",
    "mfc-podolsk-vysotnaya": "46760000",
    "mfc-dubna-baldina": "46718000",
    "mfc-krasnoarmeysk": "46743000",
    "mfc-serpuhovg": "46770000",
    "mfc-serebryanie-prudy": "46772000",
    "mfc-molodejniy": "46761000",
    "mfc-zvezdniy": "46774000",
    "mfc-lobnya-molodejnaya": "46740000",
    "mfc-orehovo-zyevo": "46757000",
    "mfc-lobnya": "46740000",
    "mfc-bronnici": "46705000",
    "mfc-kashira": "46735000",
    "mfc-noginsk-parkovaya": "46751000",
    "mfc-zvenigorod": "46730000",
    "mfc-fryazino-nahimova": "46780000",
    "mfc-lotoshino": "46629000",
    "mfc-klimovsk": "46760000",
    "mfc-jykovskiy": "46725000",
    "mfc-kraskovo": "46748000",
    "mfc-monino": "46659000",
    "mfc-dmitrov": "46715000",
    "mfc-sergiev-posad": "46615000",
    "mfc-malahovka": "46748000",
    "mfc-serpuhovmr": "46770000",
    "mfc-jeleznodorojniy": "46704000",
    "mfc-luberci-gagarina": "46748000",
    "mfc-chernogolovka": "46781000",
    "mfc-chehov": "46784000",
    "mfc-kubinka": "46641000",
    "mfc-himki2": "46783000",
    "mfc-kurovskoe": "46749000",
    "mfc-elektrogorsk": "46791000",
    "mfc-reytov-stage": "46764676",
    "mfc-kolomna": "46738000",
    "mfc-luberci": "46748000",
    "mfc-taldom": "46778000",
    "mfc-aprelevka": "46750000",
    "mfc-krasnogorsk-dachnoe": "46744000",
    "mfc-noginsk-2": "46751000",
    "mfc-sergiev-posad-2": "46615000",
    "mfc-luberci-marta": "46748000",
    "mfc-study": "22222222",
    "mfc-work-backup": "46641000",
    "mfc-odincovo-golitsyno": "46641000",
    "mfc-dmitrov-2": "46715000",
    "mfc-korolev-sigma": "46734000",
    "mfc-odincovo-lesnoy": "46641000",
    "mfc-odincovo-gorka": "46641000",
    "mfc-ramenskoe-krymskaya": "46648000",
    "mfc-losino-petrovsk-biokombinat": "46742000",
    "mfc-solnechnogorsk-2": "46652000",
    "mfc-klimovsk-2": "46760000",
    "mfc-sergiev-posad-park": "46615000",
    "mfc-odincovo-belarus": "46641000",
    "mfc-luberci-oktyabrskiy-2": "46748000",
    "mfc-himki-levoberezhnyy": "46783000",
    "mfc-himki-skhodnya": "46783000",
    "mfc-butovo": "46628000",
    "mfc-mytishi-mira": "46746000",
    "mfc-kashira-ilicha": "46735000",
    "mfc-domodedovo-baribino": "46709000",
    "mfc-solnechnogorsk-brehovo": "46652000"
}

var cursor = db.claims.find({
    "service.srguServicePassportId": "5000000010000033577",
    "activationDate": {
        $gte: ISODate("2018-12-31T21:00:00.000+0000")
    },
    $or: [{
        "deptId": {
            $exists: true
        }
    }, {
        "creatorDeptId": {
            $exists: true
        }
    }],
    "oktmo": {
        $ne: "99999999"
    },
    "consultation": false,
    "customClaimNumber": /^B090.*/i
});
print("Номер заявки;Депт;ОКТМО в заявке;Правильный ОКТМО");
cursor.forEach(function (claim) {
    var ccn = claim.customClaimNumber;
    var oktmo = claim.oktmo;
    var creatorDept = claim.creatorDeptId;
    var dept = claim.deptId;
    if (dept != undefined) {
        if (oktmos[dept] != oktmo) {
            db.claims.update({
                "customClaimNumber": ccn
            }, {
                $set: {
                    "oktmo": oktmos[dept]
                }
            }, {
                multi: true
            });
            print(ccn + ';' + dept + ';' + oktmo + ';' + oktmos[dept]);
        }
    } else if (creatorDept != undefined) {
        if (oktmos[creatorDept] != oktmo) {
            db.claims.update({
                "customClaimNumber": ccn
            }, {
                $set: {
                    "oktmo": oktmos[creatorDept]
                }
            }, {
                multi: true
            });
            print(ccn + ';' + creatorDept + ';' + oktmo + ';' + oktmos[creatorDept]);
        }
    }

});